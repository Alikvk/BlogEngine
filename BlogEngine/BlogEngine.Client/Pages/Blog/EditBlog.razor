@page "/blog/edit/{ID:int}"
@page "/blog/edit/{ID:int}/{Title}"
@inject IBlogClient BlogClient
@inject NavigationManager NavigationManager

@if (_blogUpdateDTO == null)
{
    <TextCenter Text="Loading..." />
}
else
{
    <EditBlogForm BlogUpdateDTO="_blogUpdateDTO" ValidSubmit="OnValidSubmit" />
}

@code {
    [Parameter] public int ID { get; set; }
    [Parameter] public string Title { get; set; }

    private BlogUpdateDTO _blogUpdateDTO;

    protected async override Task OnInitializedAsync()
    {
        _blogUpdateDTO = await BlogClient.GetUpdateDTOAsync(ID);
    }

    private async Task OnValidSubmit()
    {
        var updatedBlog = await BlogClient.UpdateAsync(ID, _blogUpdateDTO);
        NavigationManager.NavigateTo($"blog/view/{updatedBlog.ID}");
    }
}
@page "/blog/edit/{ID:int}"
@page "/blog/edit/{ID:int}/{Title}"
@inject IBlogService BlogService
@inject NavigationManager NavigationManager

@if (_blogUpdateDTO == null)
{
    <TextCenter Text="Loading..." />
}
else
{
    <EditBlogForm BlogUpdateDTO="_blogUpdateDTO" ValidSubmit="OnValidSubmit"/>
}

@code {
    [Parameter] public int ID { get; set; }
    [Parameter] public string Title { get; set; }

    private BlogUpdateDTO _blogUpdateDTO;

    protected async override Task OnInitializedAsync()
    {
        _blogUpdateDTO = await BlogService.GetBlogUpdateDTOAsync(ID);
    }

    private async Task OnValidSubmit()
    {
        var updatedBlog = await BlogService.UpdateBlogAsync(_blogUpdateDTO.ID, _blogUpdateDTO);
        NavigationManager.NavigateTo($"blog/view/{updatedBlog.ID}");
    }
}